<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>í•™ì‹/ê¸°ì‹ ì•±</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/food_style.css') }}">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<nav>
  <div class="nav-center">
    <button onclick="showSection('hak')">í•™ì‹</button>
    <button onclick="showSection('gi')">ê¸°ì‹</button>
    <button onclick="window.location.href='/local'">ì£¼ë³€ë§›ì§‘</button>
  </div>
</nav>

<div class="date-nav">
  <button class="nav-arrow left-arrow">â—€</button>
  <div id="date-display"></div>
  <button class="nav-arrow right-arrow">â–¶</button>
</div>
<div id="date-display" style="text-align:center; margin:10px 0; font-weight:bold;"></div>

<div id="hak" class="content">
  <div class="menu-section">
    <div class="menu-title">ğŸ± ë§›ë‚œí•œë¼</div>
    <p id="matnanhan-ggi">{{ food_menus["ë§›ë‚œí•œë¼"]|safe }}</p>
  </div>
  <div class="menu-section">
    <div class="menu-title">ğŸ¥— ê±´ê°•í•œë¼</div>
    <p id="geonganghan-ggi">{{ food_menus["ê±´ê°•í•œë¼"]|safe }}</p>
  </div>
</div>

<div id="gi" class="content" style="display:none;">
  <div class="menu-section">
    <div class="menu-title">ğŸŒ… ì•„ì¹¨</div>
    <p id="morning">{{ recommended_foods["ì•„ì¹¨"]|safe }}</p>
  </div>
  <div class="menu-section">
    <div class="menu-title">ğŸŒ ì ì‹¬</div>
    <p id="lunch">{{ recommended_foods["ì ì‹¬"]|safe }}</p>
  </div>
  <div class="menu-section">
    <div class="menu-title">ğŸŒ™ ì €ë…</div>
    <p id="dinner">{{ recommended_foods["ì €ë…"]|safe }}</p>
  </div>
</div>

<div id="local" class="content" style="display:none;">
  <div class="menu-section">
    <div class="menu-title">ì£¼ë³€ë§›ì§‘</div>
    <p>ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤...</p>
  </div>
</div>

<script>
  // ì„¹ì…˜ ì „í™˜
  function showSection(id) {
    ['hak','gi','local'].forEach(section => {
      document.getElementById(section).style.display = (section === id) ? 'block' : 'none';
    });
  }

  showSection('hak'); // ê¸°ë³¸ í‘œì‹œ í•™ì‹

  // ë‚ ì§œ í‘œì‹œ
  let currentDate = new Date();
  const dateDisplay = document.getElementById('date-display');

  function formatDate(date) {
    return date.toISOString().split('T')[0]; // 'YYYY-MM-DD'
  }

  function updateDateDisplay() {
    dateDisplay.textContent = `${formatDate(currentDate)}`;
  }

  // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
  function loadFoods(dateStr) {
    fetch(`/api/foods?date=${dateStr}`)
      .then(response => response.json())
      .then(data => {
        document.getElementById('matnanhan-ggi').innerHTML = data.food_menus["ë§›ë‚œí•œë¼"] || 'ì •ë³´ ì—†ìŒ';
        document.getElementById('geonganghan-ggi').innerHTML = data.food_menus["ê±´ê°•í•œë¼"] || 'ì •ë³´ ì—†ìŒ';
        document.getElementById('morning').innerHTML = data.recommended_foods["ì•„ì¹¨"] || 'ì •ë³´ ì—†ìŒ';
        document.getElementById('lunch').innerHTML = data.recommended_foods["ì ì‹¬"] || 'ì •ë³´ ì—†ìŒ';
        document.getElementById('dinner').innerHTML = data.recommended_foods["ì €ë…"] || 'ì •ë³´ ì—†ìŒ';
      })
      .catch(() => {
        alert('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      });
  }

  // í™”ì‚´í‘œ í´ë¦­ì‹œ ë‚ ì§œ ë³€ê²½
  document.querySelector('.left-arrow').addEventListener('click', () => {
    currentDate.setDate(currentDate.getDate() - 1);
    updateDateDisplay();
    loadFoods(formatDate(currentDate));
  });

  document.querySelector('.right-arrow').addEventListener('click', () => {
    currentDate.setDate(currentDate.getDate() + 1);
    updateDateDisplay();
    loadFoods(formatDate(currentDate));
  });

  // ì´ˆê¸° ì„¸íŒ…
  updateDateDisplay();
</script>

</body>
</html>